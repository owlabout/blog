<!DOCTYPE html> <html lang=de> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=app/logo-owl.png rel=icon type=image/png> <link href=client/main.3988107762.css rel=stylesheet><link href=client/[slug].e1cb1595.css rel=stylesheet><link href=client/client.7b2cd91c.css rel=stylesheet><link href=client/Icon.ec95d7e8.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Splitting your Vue.js project into Node.js modules</title><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div class="layout__posts layout"> <main class=layout__posts> <header class=svelte-anaggn><div class="svelte-anaggn container"><a href=/ class=svelte-anaggn><img alt="OwlAbout Blog Logo" src=/app/logo-blog.svg class=svelte-anaggn></a> </div></header> <div class=container><div class="has-sticky post svelte-1o3r1yk"><div class=hero__container style=--color-hero:#6C63FF><p><img alt="Lost without structure" src=assets/7feeb39080.svg></p> </div><h1>Splitting your Vue.js project into Node.js modules</h1> <p>There are many reasons to make your code more modular. You might want to include single modules in different projects. You may just want to add some extra structure to your project. You may want to track versions of different parts of your code. I stayed away from over-modularizing my code for a while because I didn't want the extra overhead of managing not just one code-base for my project but 10. It seemed like more work than it was worth.</p> <p>I was wrong. In fact, npm comes with some cool extra fun little features, which help you manage your modules in a way, that barely influences your standard development workflow. In the following I'm going to go through the steps to move some Vue-components of your Vue.js project to a node-module and continue on as before.</p> <h2>Create a Node.js module in the same repository</h2> <div class=sticky__container><div><div class=sticky><pre><code class=language-json><span class="token comment">// package.json of module-a</span>
<span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"module-a"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"a module for the core project"</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Becca"</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"MIT"</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"core-project"</span><span class="token operator">:</span> <span class="token string">"1.0.x"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <pre><code class=language-js><span class="token comment">// index.js of module-a</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> ModuleA <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ModuleA.vue'</span><span class="token punctuation">;</span>
</code></pre> <pre><code class=language-js><span class="token comment">// anywhere in core-project</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ModuleA <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"module-a"</span><span class="token punctuation">;</span>
</code></pre> creating a node.js module</div></div><div><p>So let's pretend I have a component called module A, which I now want to turn into a node-module. The first thing I want to do is move everything that belongs to that module into a separate folder and turn it into an isolated node module. Moving everything to a special folder is simple enough. Turns out: creating a node module is just as easy. All you need is a package.json file in your module folder and tada: node module.</p> <p>The package.json needs to have some required properties, while some are just nice to have. "name" and "version" are required fields. The "main" property will let you define an entry point for your module. It's not a required field and defaults to "index.js". I'd always include it anyway, just because I'm not a big fan of having too much implicit information.</p> <p>Creating a package.json file is not a lot of work, but if you want npm to take care of that for you, you could always use the command-line tool <code>npm init</code> from inside the module folder. It will ask you a few questions and then generate the package.json for you.</p> <p>This is my initial package.json for my module A:</p> <pre><code class=language-json><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"module-a"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"a module for the core project"</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Becca"</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"MIT"</span>
<span class="token punctuation">}</span>
</code></pre> <p>The only thing missing now is the index.js file, that I specified as the entry point. All I want this file to do is export each of the Vue components, that need to be imported into my core project:</p> <pre><code class=language-js><span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> ModuleA <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ModuleA.Vue'</span><span class="token punctuation">;</span>
</code></pre> <p>Now I can import the Vue-component "ModuleA" from anywhere in my core-project once the module has been installed or linked (I explain linking further down).</p> <pre><code class=language-js><span class="token keyword">import</span> <span class="token punctuation">{</span> ModuleA <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"module-a"</span><span class="token punctuation">;</span>
</code></pre> <h2>Use peer-dependencies for libraries and dependencies for plug-ins</h2> <p>You'll notice, that our package.json so far doesn't list any dependencies. However, our module obviously uses Vue.js, so this module will not work as a standalone repository. We could remedy this by simply adding the missing dependencies and dev-dependencies to the package.json of our module.</p> <p>As an initial setup this will work just fine. Let's say you are using Vue version "2.5.17" in your core project. If we now add the same Vue version to our module, npm will be smart enough to not install Vue twice. When going through the dependencies of Module A it will see that Vue version "2.5.17" is already installed and just leave it at that.</p> <p>What happens though if we decide to update Vue in our core project and forget to update Vue in our Module A? Npm will now see two conflicting versions of Vue and just end up installing them both to satisfy everyone's needs.</p> <pre><code>core-project
├── vue@2.7.2
└─┬ module-a
  └── vue@2.5.17
</code></pre> <p>While this will still build correctly and give you functional code, it will add extra unnecessary code, that you really don't need. Imagine having 5 tiny modules, each with its own Vue version. The modules themselves might be minuscule, but by installing 5 different versions of Vue.js your codebase will end up growing significantly with each module, that you add. We don't really want that.</p> <p>For this, npm lets us use "peer dependencies". Peer dependencies will let us specify what the core project needs to use the module. By adding a peer dependency you can actually tell npm: "If I'm being used by another project, please make sure that the project is using Vue at a minimum version of 2.x". If you then install the module in a project that does not fulfill those requirements it will simply give you a warning, that you are missing a peer-dependency.</p> <p>In my case, module A will never be used alone anyway. It is meant purely as a plugin for my core project, so there is really no reason for it to care, which version of Vue is being used, it actually only cares that the core-project is being used. So the only dependency I need to put in it, is one linking it to my core project. Module A is also currently included IN the core-project directory, meaning that it has full access to any and all modules in the node_modules directory of the core-project. If I were to move the modules somewhere else, then I would have to add Vue as an extra dependency or a peer-dependency.</p> <pre><code class=language-json><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"module-a"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"a module for the core project"</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Becca"</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"MIT"</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"core-project"</span><span class="token operator">:</span> <span class="token string">"1.0.x"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <h2>Link the module with npm link for development</h2> </div></div><div class=sticky__container><div><div class=sticky><pre><code class=language-bash><span class="token comment"># in module</span>
<span class="token function">npm</span> <span class="token function">link</span>
</code></pre> <pre><code class=language-bash><span class="token comment"># in core project</span>
<span class="token function">npm</span> <span class="token function">link</span> module-a
</code></pre> bash: link module for development</div></div><div><p>So far the new module has actually not been included in the core-project yet. We can of course just change our current imports to follow the new path of where we put our module A. But long-term we want this module to be included as a dependency in the package.json of our core project. This would, however, mean, that we would have to move our module A to its own repository and publish it on the npm registry to then install it in our core project.</p> <p>While this would work just fine, it is very inconvenient for the development of module A. Every time we made changes to a component in module A we would have to publish the changes and execute <code>npm update</code> in our core-project, just to see the changes. And we really don't want to be publishing things for development purposes.</p> <p>The most annoying solution for this would be to manually change the imports of each component that is coming from a module, every time we are developing this module. This process seems very tedious however, and we might end up forgetting to change it back somewhere.</p> <p>A slightly less annoying solution might be hosting the module not on the npm registry but on Github or a similar platform. Here we would have the possibility of changing our dependency during development to always take the head of a specified branch for that module. This would enable us to see our changes without having to publish them. It would still mean, that for each change that you make in the module, you would have to commit and push the changes, then execute <code>npm install</code> in the core project and rebuild your app. Depending on your typing speed, your internet connection and the efficiency of your build-process, this might take a few minutes. For each tiny change. Obviously, we don't want that either.</p> <p>Fortunately, npm has an easy solution for this, called <code>npm link</code>. This will essentially tell your core project to ignore the original dependency and instead look for the module locally in a specified directory. Just what we were looking for.</p> <p>Npm link is a two-step process: creating a symlink in the module directory and then linking the installation target of the core-project to the symlink of the module directory.</p> <h3>Create a symlink in the module directory</h3> <p>This step is simple enough. In your preferred terminal change into your module directory and execute npm link.</p> <pre><code class=language-bash><span class="token builtin class-name">cd</span> path-to-module
<span class="token function">npm</span> <span class="token function">link</span>
</code></pre> <p>This will create a symlink in the global npm directory that links to your module directory. This means that now, locally on your computer, npm will always know where to find module-a if you wish to link it from any project, anywhere.</p> <p>Cool stuff.</p> <h3>Linking the installation target to the module directory</h3> <p>Now all that's left to do is actually link the module from the core project:</p> <pre><code class=language-bash><span class="token builtin class-name">cd</span> path-to-core-project
<span class="token function">npm</span> <span class="token function">link</span> module-a
</code></pre> <p>Just as simple and easy. This will create a directory in your node-modules directory for your module-a, which will always mirror what is currently in your local module directory. No rebuilding, no reinstalling, no updating. The module is directly linked to your project and you can develop just as easily as before. This means that now we can run our app again with module A and keep working on both.</p> <div class=tip__container><p>Extra note: <code>npm install</code> will override any linking you have done in your project. If you want to relink your package after having executed an npm install you only need to re-execute the second step: <code>npm link module-a</code>.</p> </div><h2>Turn your project into a "lerna"-project to manage linking and publishing modules</h2> <p>If you are managing all of your modules in one single repository it might be worth it to introduce lerna. Lerna will help you link your packages and publish them with the correct versions. It requires some set up though, so I would advise reading into it a little bit. If you are interested in Lerna, check it out on <a href=https://github.com/lerna/lerna>github</a></p> </div> <div class="svelte-1oyd8c1 author-container"><div class="svelte-1oyd8c1 post-footer-info">19.05.2020: Splitting your Vue.js project into Node.js modules</div> <div class="svelte-1oyd8c1 author"><div class="svelte-1oyd8c1 tags"><span class=svelte-1oyd8c1><svg aria-hidden=true aria-label=vue class=svelte-13cndpw role=img viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><title>vue</title><path d="M356.9 64.3H280l-56 88.6-48-88.6H0L224 448 448 64.3h-91.1zm-301.2 32h53.8L224 294.5 338.4 96.3h53.8L224 384.5 55.7 96.3z" fill=currentColor></path></svg></span><span class=svelte-1oyd8c1><svg aria-hidden=true aria-label=node class=svelte-13cndpw role=img viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><title>node</title><path d="M224 508c-6.7 0-13.5-1.8-19.4-5.2l-61.7-36.5c-9.2-5.2-4.7-7-1.7-8 12.3-4.3 14.8-5.2 27.9-12.7 1.4-.8 3.2-.5 4.6.4l47.4 28.1c1.7 1 4.1 1 5.7 0l184.7-106.6c1.7-1 2.8-3 2.8-5V149.3c0-2.1-1.1-4-2.9-5.1L226.8 37.7c-1.7-1-4-1-5.7 0L36.6 144.3c-1.8 1-2.9 3-2.9 5.1v213.1c0 2 1.1 4 2.9 4.9l50.6 29.2c27.5 13.7 44.3-2.4 44.3-18.7V167.5c0-3 2.4-5.3 5.4-5.3h23.4c2.9 0 5.4 2.3 5.4 5.3V378c0 36.6-20 57.6-54.7 57.6-10.7 0-19.1 0-42.5-11.6l-48.4-27.9C8.1 389.2.7 376.3.7 362.4V149.3c0-13.8 7.4-26.8 19.4-33.7L204.6 9c11.7-6.6 27.2-6.6 38.8 0l184.7 106.7c12 6.9 19.4 19.8 19.4 33.7v213.1c0 13.8-7.4 26.7-19.4 33.7L243.4 502.8c-5.9 3.4-12.6 5.2-19.4 5.2zm149.1-210.1c0-39.9-27-50.5-83.7-58-57.4-7.6-63.2-11.5-63.2-24.9 0-11.1 4.9-25.9 47.4-25.9 37.9 0 51.9 8.2 57.7 33.8.5 2.4 2.7 4.2 5.2 4.2h24c1.5 0 2.9-.6 3.9-1.7s1.5-2.6 1.4-4.1c-3.7-44.1-33-64.6-92.2-64.6-52.7 0-84.1 22.2-84.1 59.5 0 40.4 31.3 51.6 81.8 56.6 60.5 5.9 65.2 14.8 65.2 26.7 0 20.6-16.6 29.4-55.5 29.4-48.9 0-59.6-12.3-63.2-36.6-.4-2.6-2.6-4.5-5.3-4.5h-23.9c-3 0-5.3 2.4-5.3 5.3 0 31.1 16.9 68.2 97.8 68.2 58.4-.1 92-23.2 92-63.4z" fill=currentColor></path></svg></span><span class=svelte-1oyd8c1><svg aria-hidden=true aria-label=webDesign class=svelte-13cndpw role=img viewBox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><title>webDesign</title><path d="M136.6 138.79a64.003 64.003 0 0 0-43.31 41.35L0 460l14.69 14.69L164.8 324.58c-2.99-6.26-4.8-13.18-4.8-20.58 0-26.51 21.49-48 48-48s48 21.49 48 48-21.49 48-48 48c-7.4 0-14.32-1.81-20.58-4.8L37.31 497.31 52 512l279.86-93.29a64.003 64.003 0 0 0 41.35-43.31L416 224 288 96l-151.4 42.79zm361.34-64.62l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.75 18.75-49.15 0-67.91z" fill=currentColor></path></svg></span></div> <div class="svelte-1oyd8c1 thumbnail"><img alt="" src=/images/becca.jpg></div> <div class="svelte-1oyd8c1 info"><b>Becca Roberts</b> <p class=svelte-1oyd8c1>Software developer working mainly with Vue.js. I do some web-design stuff in my free time. I'm still at the beginning, learning lots every day and I try to explain stuff ein learn the way I wish it might have been explained to me.</div></div> </div></div></div></div></main> <footer class=svelte-1txo2c3><div class="svelte-1txo2c3 container"><a href=https://owlabout.de/impressum.html class=svelte-1txo2c3 rel=noopener>Impressum</a> <a href=https://owlabout.de/datenschutz.html class=svelte-1txo2c3 rel=noopener>Datenschutz </a> <a href=https://owlabout.de/#contact class=svelte-1txo2c3 rel=noopener>Kontakt</a> <a href=https://owlabout.de/ class=svelte-1txo2c3 rel=noopener><img alt=owlabout src=/app/logo-owl.png class=svelte-1txo2c3></a></div></footer></div></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,null,null,(function(a){return {post:{title:a,metadata:{slug:"organizing-nodejs-modules",link:"\u002Fposts\u002F2020\u002F05\u002Forganizing-nodejs-modules",dateString:"19.05.2020",date:"2020-05-19T00:00:00.000Z",author:"Becca",lang:"en",title:a,thumbnail:"assets\u002F7feeb39080.svg",tags:["node","vue"],file:"posts\u002Fvue\u002Forganizing-nodejs-modules.md"},html:"\u003Cdiv class=\"hero__container\"  style='--color-hero: #6C63FF;'\u003E\u003Cp\u003E\u003Cimg src=\"assets\u002F7feeb39080.svg\" alt=\"Lost without structure\"\u003E\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\u003Ch1\u003ESplitting your Vue.js project into Node.js modules\u003C\u002Fh1\u003E\n\u003Cp\u003EThere are many reasons to make your code more modular. You might want to include single modules in different projects. You may just want to add some extra structure to your project. You may want to track versions of different parts of your code. I stayed away from over-modularizing my code for a while because I didn't want the extra overhead of managing not just one code-base for my project but 10. It seemed like more work than it was worth.\u003C\u002Fp\u003E\n\u003Cp\u003EI was wrong. In fact, npm comes with some cool extra fun little features, which help you manage your modules in a way, that barely influences your standard development workflow. In the following I'm going to go through the steps to move some Vue-components of your Vue.js project to a node-module and continue on as before.\u003C\u002Fp\u003E\n\u003Ch2\u003ECreate a Node.js module in the same repository\u003C\u002Fh2\u003E\n\u003Cdiv class=\"sticky__container\"\u003E\u003Cdiv\u003E\u003Cdiv class=\"sticky\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F package.json of module-a\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"name\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"module-a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"version\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"1.0.0\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"description\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"a module for the core project\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"main\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"index.js\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"author\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Becca\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"license\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"MIT\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"dependencies\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token property\"\u003E\"core-project\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"1.0.x\"\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F index.js of module-a\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edefault\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eas\u003C\u002Fspan\u003E ModuleA \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'.\u002FModuleA.vue'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F anywhere in core-project\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E ModuleA \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"module-a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\ncreating a node.js module\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv\u003E\u003Cp\u003ESo let's pretend I have a component called module A, which I now want to turn into a node-module.\nThe first thing I want to do is move everything that belongs to that module into a separate folder and turn it into an isolated node module.\nMoving everything to a special folder is simple enough. Turns out: creating a node module is just as easy. All you need is a package.json file in your module folder and tada: node module.\u003C\u002Fp\u003E\n\u003Cp\u003EThe package.json needs to have some required properties, while some are just nice to have. &quot;name&quot; and &quot;version&quot; are required fields. The &quot;main&quot; property will let you define an entry point for your module. It's not a required field and defaults to &quot;index.js&quot;. I'd always include it anyway, just because I'm not a big fan of having too much implicit information.\u003C\u002Fp\u003E\n\u003Cp\u003ECreating a package.json file is not a lot of work, but if you want npm to take care of that for you, you could always use the command-line tool \u003Ccode\u003Enpm init\u003C\u002Fcode\u003E from inside the module folder. It will ask you a few questions and then generate the package.json for you.\u003C\u002Fp\u003E\n\u003Cp\u003EThis is my initial package.json for my module A:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"name\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"module-a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"version\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"1.0.0\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"description\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"a module for the core project\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"main\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"index.js\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"author\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Becca\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"license\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"MIT\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe only thing missing now is the index.js file, that I specified as the entry point.\nAll I want this file to do is export each of the Vue components, that need to be imported into my core project:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edefault\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eas\u003C\u002Fspan\u003E ModuleA \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'.\u002FModuleA.Vue'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENow I can import the Vue-component &quot;ModuleA&quot; from anywhere in my core-project once the module has been installed or linked (I explain linking further down).\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E ModuleA \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"module-a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003EUse peer-dependencies for libraries and dependencies for plug-ins\u003C\u002Fh2\u003E\n\u003Cp\u003EYou'll notice, that our package.json so far doesn't list any dependencies. However, our module obviously uses Vue.js, so this module will not work as a standalone repository. We could remedy this by simply adding the missing dependencies and dev-dependencies to the package.json of our module.\u003C\u002Fp\u003E\n\u003Cp\u003EAs an initial setup this will work just fine. Let's say you are using Vue version &quot;2.5.17&quot; in your core project. If we now add the same Vue version to our module, npm will be smart enough to not install Vue twice. When going through the dependencies of Module A it will see that Vue version &quot;2.5.17&quot; is already installed and just leave it at that.\u003C\u002Fp\u003E\n\u003Cp\u003EWhat happens though if we decide to update Vue in our core project and forget to update Vue in our Module A? Npm will now see two conflicting versions of Vue and just end up installing them both to satisfy everyone's needs.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Ecore-project\n├── vue@2.7.2\n└─┬ module-a\n  └── vue@2.5.17\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWhile this will still build correctly and give you functional code, it will add extra unnecessary code, that you really don't need. Imagine having 5 tiny modules, each with its own Vue version. The modules themselves might be minuscule, but by installing 5 different versions of Vue.js your codebase will end up growing significantly with each module, that you add. We don't really want that.\u003C\u002Fp\u003E\n\u003Cp\u003EFor this, npm lets us use &quot;peer dependencies&quot;. Peer dependencies will let us specify what the core project needs to use the module. By adding a peer dependency you can actually tell npm: &quot;If I'm being used by another project, please make sure that the project is using Vue at a minimum version of 2.x&quot;. If you then install the module in a project that does not fulfill those requirements it will simply give you a warning, that you are missing a peer-dependency.\u003C\u002Fp\u003E\n\u003Cp\u003EIn my case, module A will never be used alone anyway. It is meant purely as a plugin for my core project, so there is really no reason for it to care, which version of Vue is being used, it actually only cares that the core-project is being used. So the only dependency I need to put in it, is one linking it to my core project.\nModule A is also currently included IN the core-project directory, meaning that it has full access to any and all modules in the node_modules directory of the core-project. If I were to move the modules somewhere else, then I would have to add Vue as an extra dependency or a peer-dependency.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"name\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"module-a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"version\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"1.0.0\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"description\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"a module for the core project\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"main\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"index.js\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"author\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Becca\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"license\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"MIT\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"dependencies\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token property\"\u003E\"core-project\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"1.0.x\"\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003ELink the module with npm link for development\u003C\u002Fh2\u003E\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"sticky__container\"\u003E\u003Cdiv\u003E\u003Cdiv class=\"sticky\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token comment\"\u003E# in module\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Enpm\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elink\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token comment\"\u003E# in core project\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Enpm\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elink\u003C\u002Fspan\u003E module-a\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\nbash: link module for development\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv\u003E\u003Cp\u003ESo far the new module has actually not been included in the core-project yet. We can of course just change our current imports to follow the new path of where we put our module A. But long-term we want this module to be included as a dependency in the package.json of our core project. This would, however, mean, that we would have to move our module A to its own repository and publish it on the npm registry to then install it in our core project.\u003C\u002Fp\u003E\n\u003Cp\u003EWhile this would work just fine, it is very inconvenient for the development of module A. Every time we made changes to a component in module A we would have to publish the changes and execute \u003Ccode\u003Enpm update\u003C\u002Fcode\u003E in our core-project, just to see the changes. And we really don't want to be publishing things for development purposes.\u003C\u002Fp\u003E\n\u003Cp\u003EThe most annoying solution for this would be to manually change the imports of each component that is coming from a module, every time we are developing this module. This process seems very tedious however, and we might end up forgetting to change it back somewhere.\u003C\u002Fp\u003E\n\u003Cp\u003EA slightly less annoying solution might be hosting the module not on the npm registry but on Github or a similar platform. Here we would have the possibility of changing our dependency during development to always take the head of a specified branch for that module. This would enable us to see our changes without having to publish them. It would still mean, that for each change that you make in the module, you would have to commit and push the changes, then execute \u003Ccode\u003Enpm install\u003C\u002Fcode\u003E in the core project and rebuild your app. Depending on your typing speed, your internet connection and the efficiency of your build-process, this might take a few minutes. For each tiny change. Obviously, we don't want that either.\u003C\u002Fp\u003E\n\u003Cp\u003EFortunately, npm has an easy solution for this, called \u003Ccode\u003Enpm link\u003C\u002Fcode\u003E. This will essentially tell your core project to ignore the original dependency and instead look for the module locally in a specified directory. Just what we were looking for.\u003C\u002Fp\u003E\n\u003Cp\u003ENpm link is a two-step process: creating a symlink in the module directory and then linking the installation target of the core-project to the symlink of the module directory.\u003C\u002Fp\u003E\n\u003Ch3\u003ECreate a symlink in the module directory\u003C\u002Fh3\u003E\n\u003Cp\u003EThis step is simple enough. In your preferred terminal change into your module directory and execute npm link.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token builtin class-name\"\u003Ecd\u003C\u002Fspan\u003E path-to-module\n\u003Cspan class=\"token function\"\u003Enpm\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elink\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis will create a symlink in the global npm directory that links to your module directory. This means that now, locally on your computer, npm will always know where to find module-a if you wish to link it from any project, anywhere.\u003C\u002Fp\u003E\n\u003Cp\u003ECool stuff.\u003C\u002Fp\u003E\n\u003Ch3\u003ELinking the installation target to the module directory\u003C\u002Fh3\u003E\n\u003Cp\u003ENow all that's left to do is actually link the module from the core project:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token builtin class-name\"\u003Ecd\u003C\u002Fspan\u003E path-to-core-project\n\u003Cspan class=\"token function\"\u003Enpm\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elink\u003C\u002Fspan\u003E module-a\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EJust as simple and easy. This will create a directory in your node-modules directory for your module-a, which will always mirror what is currently in your local module directory. No rebuilding, no reinstalling, no updating. The module is directly linked to your project and you can develop just as easily as before. This means that now we can run our app again with module A and keep working on both.\u003C\u002Fp\u003E\n\u003Cdiv class=\"tip__container\"\u003E\u003Cp\u003EExtra note: \u003Ccode\u003Enpm install\u003C\u002Fcode\u003E will override any linking you have done in your project. If you want to relink your package after having executed an npm install you only need to re-execute the second step: \u003Ccode\u003Enpm link module-a\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\u003Ch2\u003ETurn your project into a &quot;lerna&quot;-project to manage linking and publishing modules\u003C\u002Fh2\u003E\n\u003Cp\u003EIf you are managing all of your modules in one single repository it might be worth it to introduce lerna. Lerna will help you link your packages and publish them with the correct versions. It requires some set up though, so I would advise reading into it a little bit. If you are interested in Lerna, check it out on \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flerna\u002Flerna\"\u003Egithub\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n"}}}("Splitting your Vue.js project into Node.js modules"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.7b2cd91c.js"}catch(e){main="/client/legacy/client.fdd6d4c4.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 